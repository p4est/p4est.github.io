<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>p4est: test_coordinates2.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">p4est
   &#160;<span id="projectnumber">2.8.7</span>
   </div>
   <div id="projectbrief">p4est is a software library for parallel adaptive mesh refinement.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">test_coordinates2.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>Generate coordinate tuples for quadrants, uniquify and hash them.Please see the page on <a class="el" href="forest_coordinates.html">The p4est coordinate system</a> for further details.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">  This file is part of p4est.</span></div>
<div class="line"><span class="comment">  p4est is a C library to manage a collection (a forest) of multiple</span></div>
<div class="line"><span class="comment">  connected adaptive quadtrees or octrees in parallel.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  Copyright (C) 2010 The University of Texas System</span></div>
<div class="line"><span class="comment">  Additional copyright (C) 2011 individual authors</span></div>
<div class="line"><span class="comment">  Written by Carsten Burstedde, Lucas C. Wilcox, and Tobin Isaac</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  p4est is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">  it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">  the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><span class="comment">  (at your option) any later version.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  p4est is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment">  GNU General Public License for more details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">  along with p4est; if not, write to the Free Software Foundation, Inc.,</span></div>
<div class="line"><span class="comment">  51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Generate coordinate tuples for quadrants and hash them. */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef P4_TO_P8</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="p4est__bits_8h.html">p4est_bits.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="p4est__connectivity_8h.html">p4est_connectivity.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="p8est__bits_8h.html">p8est_bits.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="p8est__connectivity_8h.html">p8est_connectivity.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* A coordinate point is uniquefied by adding the lowest touching tree */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>coordinates_hash_key</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="p4est__base_8h.html#a05ea8ceb664ae2403fbcf7b1dcc70ea0">p4est_qcoord_t</a>      coords[<a name="a0"></a><a class="code" href="p4est__connectivity_8h.html#a2c4786e65053166a16b7afb2711d35cb">P4EST_DIM</a>];        <span class="comment">/* in/on the unit tree */</span></div>
<div class="line">  <a class="code" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a>      which_tree;       <span class="comment">/* legal wrt. connectivity */</span></div>
<div class="line">}</div>
<div class="line">coordinates_hash_key_t;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Provide an allocator for the key data as well as the hash map itself */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>coordinates_hash_data</div>
<div class="line">{</div>
<div class="line">  sc_mempool_t       *ckeys;    <span class="comment">/* memory pool for allocating the hash keys */</span></div>
<div class="line">  sc_hash_t          *chash;    <span class="comment">/* the hash map links keys without copying */</span></div>
<div class="line">  <a class="code" href="p4est__base_8h.html#a9f350ee78755ec6e7d25fb1dca474573">p4est_locidx_t</a>      added;    <span class="comment">/* count each coordinate point just once */</span></div>
<div class="line">  <a class="code" href="p4est__base_8h.html#a9f350ee78755ec6e7d25fb1dca474573">p4est_locidx_t</a>      duped;    <span class="comment">/* count attempts to add more than once */</span></div>
<div class="line">}</div>
<div class="line">coordinates_hash_data_t;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Calculate a hash function for a coordinate point */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span></div>
<div class="line">coordinates_hash_fn (<span class="keyword">const</span> <span class="keywordtype">void</span> *v, <span class="keyword">const</span> <span class="keywordtype">void</span> *u)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> coordinates_hash_key_t *k = (coordinates_hash_key_t *) v;</div>
<div class="line">  uint32_t            a, b, c;</div>
<div class="line"> </div>
<div class="line">  P4EST_ASSERT (k != NULL);</div>
<div class="line"> </div>
<div class="line">  a = (uint32_t) k-&gt;coords[0];</div>
<div class="line">  b = (uint32_t) k-&gt;coords[1];</div>
<div class="line"><span class="preprocessor">#ifndef P4_TO_P8</span></div>
<div class="line">  c = (uint32_t) k-&gt;which_tree;</div>
<div class="line">#<span class="keywordflow">else</span></div>
<div class="line">  c = (uint32_t) k-&gt;coords[2];</div>
<div class="line">  sc_hash_mix (a, b, c);</div>
<div class="line">  a += (uint32_t) k-&gt;which_tree;</div>
<div class="line">#endif</div>
<div class="line">  sc_hash_final (a, b, c);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span>) c;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Determine whether two coordinate points are equal */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">coordinates_equal_fn (<span class="keyword">const</span> <span class="keywordtype">void</span> *v1, <span class="keyword">const</span> <span class="keywordtype">void</span> *v2, <span class="keyword">const</span> <span class="keywordtype">void</span> *u)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> coordinates_hash_key_t *k1 = (coordinates_hash_key_t *) v1;</div>
<div class="line">  <span class="keyword">const</span> coordinates_hash_key_t *k2 = (coordinates_hash_key_t *) v2;</div>
<div class="line"> </div>
<div class="line">  P4EST_ASSERT (k1 != NULL);</div>
<div class="line">  P4EST_ASSERT (k2 != NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> k1-&gt;which_tree == k2-&gt;which_tree &amp;&amp;</div>
<div class="line">    !memcmp (k1-&gt;coords, k2-&gt;coords, <a class="code" href="p4est__connectivity_8h.html#a2c4786e65053166a16b7afb2711d35cb">P4EST_DIM</a> * sizeof (<a class="code" href="p4est__base_8h.html#a05ea8ceb664ae2403fbcf7b1dcc70ea0">p4est_qcoord_t</a>));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Check whether a p4est node quadrant sits at a given coordinate tuple */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">test_node_coordinates (<span class="keyword">const</span> <a name="_a1"></a><a class="code" href="structp4est__quadrant.html">p4est_quadrant_t</a> *r,</div>
<div class="line">                       <span class="keyword">const</span> <a class="code" href="p4est__base_8h.html#a05ea8ceb664ae2403fbcf7b1dcc70ea0">p4est_qcoord_t</a> coords[])</div>
<div class="line">{</div>
<div class="line">  P4EST_ASSERT (r != NULL);</div>
<div class="line">  P4EST_ASSERT (<a name="a2"></a><a class="code" href="p4est__bits_8h.html#a1941e7d00d0d38d89865b4140c172a50">p4est_quadrant_is_node</a> (r, 0));</div>
<div class="line">  P4EST_ASSERT (coords != NULL);</div>
<div class="line">  <span class="keywordflow">return</span> (r-&gt;<a name="a3"></a>x == coords[0] &amp;&amp; r-&gt;<a name="a4"></a><a class="code" href="structp4est__quadrant.html#ad226034132b973fe7955ef797938dea0">y</a> == coords[1] &amp;&amp;</div>
<div class="line">#ifdef P4_TO_P8</div>
<div class="line">          r-&gt;z == coords[2] &amp;&amp;</div>
<div class="line">#endif</div>
<div class="line">          1);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Allocate and initialize hash key and try to add coordinates to map */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">test_hash (coordinates_hash_data_t *hdata,</div>
<div class="line">           <a class="code" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> tt, <span class="keyword">const</span> <a class="code" href="p4est__base_8h.html#a05ea8ceb664ae2403fbcf7b1dcc70ea0">p4est_qcoord_t</a> coords[])</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">void</span>              **found;</div>
<div class="line">  coordinates_hash_key_t *k;</div>
<div class="line"> </div>
<div class="line">  k = (coordinates_hash_key_t *) sc_mempool_alloc (hdata-&gt;ckeys);</div>
<div class="line">  k-&gt;which_tree = tt;</div>
<div class="line">  k-&gt;coords[0] = coords[0];</div>
<div class="line">  k-&gt;coords[1] = coords[1];</div>
<div class="line"><span class="preprocessor">#ifdef P4_TO_P8</span></div>
<div class="line">  k-&gt;coords[2] = coords[2];</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <span class="keywordflow">if</span> (sc_hash_insert_unique (hdata-&gt;chash, k, &amp;found)) {</div>
<div class="line">    <span class="comment">/* The key is newly linked into the hash table: count it */</span></div>
<div class="line">    P4EST_ASSERT (*found == k);</div>
<div class="line"><span class="preprocessor">#ifndef P4_TO_P8</span></div>
<div class="line">    P4EST_INFOF (<span class="stringliteral">&quot;First time adding tree %ld, coordinates %lx %lx\n&quot;</span>,</div>
<div class="line">                 (<span class="keywordtype">long</span>) tt, (<span class="keywordtype">long</span>) coords[0], (<span class="keywordtype">long</span>) coords[1]);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    P4EST_INFOF (<span class="stringliteral">&quot;First time adding tree %ld, coordinates %lx %lx %lx\n&quot;</span>,</div>
<div class="line">                 (<span class="keywordtype">long</span>) tt, (<span class="keywordtype">long</span>) coords[0], (<span class="keywordtype">long</span>) coords[1],</div>
<div class="line">                 (<span class="keywordtype">long</span>) coords[2]);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    ++hdata-&gt;added;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">/* The key for this coordinate had already been stored earlier */</span></div>
<div class="line">    P4EST_ASSERT (*found != k);</div>
<div class="line">    sc_mempool_free (hdata-&gt;ckeys, k);</div>
<div class="line">    ++hdata-&gt;duped;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* The main routine to test our coordinate functions */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">test_connectivity (sc_MPI_Comm mpicomm, <a name="_a5"></a><a class="code" href="structp4est__connectivity.html">p4est_connectivity_t</a> *conn)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span>                 mpiret;</div>
<div class="line">  <span class="keywordtype">int</span>                 size, rank;</div>
<div class="line">  <span class="keywordtype">int</span>                 face, corner;</div>
<div class="line"><span class="preprocessor">#ifdef P4_TO_P8</span></div>
<div class="line">  <span class="keywordtype">int</span>                 edge;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <a class="code" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a>      num_trees, tt, nt;</div>
<div class="line">  <a class="code" href="p4est__base_8h.html#a05ea8ceb664ae2403fbcf7b1dcc70ea0">p4est_qcoord_t</a>      coords[<a class="code" href="p4est__connectivity_8h.html#a2c4786e65053166a16b7afb2711d35cb">P4EST_DIM</a>];</div>
<div class="line">  <a class="code" href="p4est__base_8h.html#a05ea8ceb664ae2403fbcf7b1dcc70ea0">p4est_qcoord_t</a>      coords_out[<a class="code" href="p4est__connectivity_8h.html#a2c4786e65053166a16b7afb2711d35cb">P4EST_DIM</a>];</div>
<div class="line">  <a class="code" href="structp4est__quadrant.html">p4est_quadrant_t</a>    root, *q, node, *r;</div>
<div class="line">  coordinates_hash_data_t shdata, *hdata = &amp;shdata;</div>
<div class="line"> </div>
<div class="line">  mpiret = sc_MPI_Comm_size (mpicomm, &amp;size);</div>
<div class="line">  SC_CHECK_MPI (mpiret);</div>
<div class="line">  mpiret = sc_MPI_Comm_rank (mpicomm, &amp;rank);</div>
<div class="line">  SC_CHECK_MPI (mpiret);</div>
<div class="line"> </div>
<div class="line">  P4EST_ASSERT (<a name="a6"></a><a class="code" href="p4est__connectivity_8h.html#a3780b75fcd2a5b578c6dc294c4e77a5e">p4est_connectivity_is_valid</a> (conn));</div>
<div class="line">  num_trees = conn-&gt;<a name="a7"></a><a class="code" href="structp4est__connectivity.html#a1068e552922e0e98a1f2477020392b25">num_trees</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (rank != 0) {</div>
<div class="line">    <span class="comment">/* the connectivity is the same on every rank */</span></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* hash table for coordinate counting and checking */</span></div>
<div class="line">  hdata-&gt;ckeys = sc_mempool_new (<span class="keyword">sizeof</span> (coordinates_hash_key_t));</div>
<div class="line">  hdata-&gt;chash = sc_hash_new (coordinates_hash_fn, coordinates_equal_fn,</div>
<div class="line">                              hdata, NULL);</div>
<div class="line">  hdata-&gt;added = hdata-&gt;duped = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* initialize quadrant storage */</span></div>
<div class="line">  <a name="a8"></a><a class="code" href="p4est__bits_8h.html#a571cd89e7cf1723a5d0702146d62a61f">p4est_quadrant_root</a> (q = &amp;root);</div>
<div class="line">  r = &amp;node;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* loop over all trees in the connectivity */</span></div>
<div class="line">  <span class="keywordflow">for</span> (tt = 0; tt &lt; num_trees; ++tt) {</div>
<div class="line">    P4EST_INFOF (<span class="stringliteral">&quot;Going through tree %ld\n&quot;</span>, (<span class="keywordtype">long</span>) tt);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* verify volume midpoint */</span></div>
<div class="line">    <a name="a9"></a><a class="code" href="p4est__bits_8h.html#a1c0bd87bc88f3389fa5f224922ce060a">p4est_quadrant_volume_coordinates</a> (q, coords);</div>
<div class="line">    <a name="a10"></a><a class="code" href="p4est__connectivity_8h.html#a35a4816ff10305a61d0e749ec9888a6d">p4est_connectivity_coordinates_canonicalize</a></div>
<div class="line">      (conn, tt, coords, &amp;nt, coords_out);</div>
<div class="line">    SC_CHECK_ABORT (nt == tt, <span class="stringliteral">&quot;Mysterious volume tree&quot;</span>);</div>
<div class="line">    SC_CHECK_ABORT (!<a name="a11"></a><a class="code" href="p4est__bits_8h.html#a10f5aa2481ba7353f47cb9174e1cd4f6">p4est_coordinates_compare</a> (coords, coords_out),</div>
<div class="line">                    <span class="stringliteral">&quot;Mysterious volume coordinates&quot;</span>);</div>
<div class="line">    test_hash (hdata, nt, coords_out);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (face = 0; face &lt; <a name="a12"></a><a class="code" href="p4est__connectivity_8h.html#a69ad217418caeaf00fa92f492ab0faaa">P4EST_FACES</a>; ++face) {</div>
<div class="line">      <span class="comment">/* verify face midpoints */</span></div>
<div class="line">      <a name="a13"></a><a class="code" href="p4est__bits_8h.html#a3d045f30f00319ac7410db08b8753a3e">p4est_quadrant_face_coordinates</a> (q, face, coords);</div>
<div class="line">      <a class="code" href="p4est__connectivity_8h.html#a35a4816ff10305a61d0e749ec9888a6d">p4est_connectivity_coordinates_canonicalize</a></div>
<div class="line">        (conn, tt, coords, &amp;nt, coords_out);</div>
<div class="line">      SC_CHECK_ABORT (nt &lt;= tt, <span class="stringliteral">&quot;Mysterious face tree&quot;</span>);</div>
<div class="line">      SC_CHECK_ABORT (nt &lt; tt ||</div>
<div class="line">                      <a class="code" href="p4est__bits_8h.html#a10f5aa2481ba7353f47cb9174e1cd4f6">p4est_coordinates_compare</a> (coords, coords_out) &gt;= 0,</div>
<div class="line">                      <span class="stringliteral">&quot;Mysterious face coordinates&quot;</span>);</div>
<div class="line">      test_hash (hdata, nt, coords_out);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef P4_TO_P8</span></div>
<div class="line">    <span class="keywordflow">for</span> (edge = 0; edge &lt; <a name="a14"></a><a class="code" href="p8est__connectivity_8h.html#ad63a4ac1ac2795008bc8b9dd225bc3a2">P8EST_EDGES</a>; ++edge) {</div>
<div class="line">      <span class="comment">/* verify edge midpoints */</span></div>
<div class="line">      <a name="a15"></a><a class="code" href="p8est__bits_8h.html#a5f813e85958c05b884416e5909b6bedb">p8est_quadrant_edge_coordinates</a> (q, edge, coords);</div>
<div class="line">      <a class="code" href="p4est__connectivity_8h.html#a35a4816ff10305a61d0e749ec9888a6d">p4est_connectivity_coordinates_canonicalize</a></div>
<div class="line">        (conn, tt, coords, &amp;nt, coords_out);</div>
<div class="line">      SC_CHECK_ABORT (nt &lt;= tt, <span class="stringliteral">&quot;Mysterious edge tree&quot;</span>);</div>
<div class="line">      SC_CHECK_ABORT (nt &lt; tt ||</div>
<div class="line">                      <a class="code" href="p4est__bits_8h.html#a10f5aa2481ba7353f47cb9174e1cd4f6">p4est_coordinates_compare</a> (coords, coords_out) &gt;= 0,</div>
<div class="line">                      <span class="stringliteral">&quot;Mysterious edge coordinates&quot;</span>);</div>
<div class="line">      test_hash (hdata, nt, coords_out);</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (corner = 0; corner &lt; <a name="a16"></a><a class="code" href="p4est__connectivity_8h.html#acb49ce9f7b688a2c6b6d62bda9ff5555">P4EST_CHILDREN</a>; ++corner) {</div>
<div class="line">      <span class="comment">/* verify tree corners */</span></div>
<div class="line">      <a name="a17"></a><a class="code" href="p4est__bits_8h.html#ada26b2e2ae47969c6a58a9fda446847f">p4est_quadrant_corner_node</a> (q, corner, r);</div>
<div class="line">      <a name="a18"></a><a class="code" href="p4est__bits_8h.html#aa415031cb5088b5c1344b2421605c4c1">p4est_quadrant_corner_coordinates</a> (q, corner, coords);</div>
<div class="line">      SC_CHECK_ABORT (test_node_coordinates (r, coords), <span class="stringliteral">&quot;Node coordinates&quot;</span>);</div>
<div class="line">      <a class="code" href="p4est__connectivity_8h.html#a35a4816ff10305a61d0e749ec9888a6d">p4est_connectivity_coordinates_canonicalize</a></div>
<div class="line">        (conn, tt, coords, &amp;nt, coords_out);</div>
<div class="line">      SC_CHECK_ABORT (nt &lt;= tt, <span class="stringliteral">&quot;Mysterious corner tree&quot;</span>);</div>
<div class="line">      SC_CHECK_ABORT (nt &lt; tt ||</div>
<div class="line">                      <a class="code" href="p4est__bits_8h.html#a10f5aa2481ba7353f47cb9174e1cd4f6">p4est_coordinates_compare</a> (coords, coords_out) &gt;= 0,</div>
<div class="line">                      <span class="stringliteral">&quot;Mysterious corner coordinates&quot;</span>);</div>
<div class="line">      test_hash (hdata, nt, coords_out);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* clean up memory */</span></div>
<div class="line">  sc_hash_destroy (hdata-&gt;chash);</div>
<div class="line">  sc_mempool_destroy (hdata-&gt;ckeys);</div>
<div class="line">  P4EST_PRODUCTIONF (<span class="stringliteral">&quot;Added %ld coordinates, duplicates %ld\n&quot;</span>,</div>
<div class="line">                     (<span class="keywordtype">long</span>) hdata-&gt;added, (<span class="keywordtype">long</span>) hdata-&gt;duped);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* wrapper around test routine */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">test_coordinates (sc_MPI_Comm mpicomm)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">/* a connectivity stores connections between the trees in the mesh */</span></div>
<div class="line">  <a class="code" href="structp4est__connectivity.html">p4est_connectivity_t</a> *conn;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef P4_TO_P8</span></div>
<div class="line">  <span class="comment">/* this connectivity has three 2D trees all connected at one corner */</span></div>
<div class="line">  conn = <a name="a19"></a><a class="code" href="p4est__connectivity_8h.html#ad6fcb80b167783b7ab298755473c8177">p4est_connectivity_new_corner</a> ();</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  <span class="comment">/* this connectivity has six 3D trees connected in some blocky way */</span></div>
<div class="line">  conn = <a name="a20"></a><a class="code" href="p8est__connectivity_8h.html#ac88e4c055b8847d3c9074c17c624da6e">p8est_connectivity_new_rotcubes</a> ();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* run the actual test routine */</span></div>
<div class="line">  test_connectivity (mpicomm, conn);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* the connectivity is no longer used */</span></div>
<div class="line">  <a name="a21"></a><a class="code" href="p4est__connectivity_8h.html#a208e613cae5e1bd3baffb587387b672c">p4est_connectivity_destroy</a> (conn);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* boilerplate code and calling the test routine */</span></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  sc_MPI_Comm         mpicomm;</div>
<div class="line">  <span class="keywordtype">int</span>                 mpiret;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* initialize MPI environment */</span></div>
<div class="line">  mpiret = sc_MPI_Init (&amp;argc, &amp;argv);</div>
<div class="line">  SC_CHECK_MPI (mpiret);</div>
<div class="line">  mpicomm = sc_MPI_COMM_WORLD;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* establish parallel logging */</span></div>
<div class="line">  sc_init (mpicomm, 1, 1, NULL, SC_LP_DEFAULT);</div>
<div class="line">  <a name="a22"></a><a class="code" href="p4est__base_8h.html#aab4b16aa58790d309e0cf46ed665c6b9">p4est_init</a> (NULL, SC_LP_DEFAULT);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* proceed with tests */</span></div>
<div class="line">  test_coordinates (mpicomm);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* clean up and exit */</span></div>
<div class="line">  sc_finalize ();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* finalize MPI environment */</span></div>
<div class="line">  mpiret = sc_MPI_Finalize ();</div>
<div class="line">  SC_CHECK_MPI (mpiret);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* by default exit cleanly */</span></div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="ap4est__base_8h_html_a05ea8ceb664ae2403fbcf7b1dcc70ea0"><div class="ttname"><a href="p4est__base_8h.html#a05ea8ceb664ae2403fbcf7b1dcc70ea0">p4est_qcoord_t</a></div><div class="ttdeci">int32_t p4est_qcoord_t</div><div class="ttdoc">Typedef for quadrant coordinates.</div><div class="ttdef"><b>Definition:</b> p4est_base.h:81</div></div>
<div class="ttc" id="ap4est__base_8h_html_a8e849f705b0d4d1702b8f5102823f48c"><div class="ttname"><a href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a></div><div class="ttdeci">int32_t p4est_topidx_t</div><div class="ttdoc">Typedef for counting topological entities (trees, tree vertices).</div><div class="ttdef"><b>Definition:</b> p4est_base.h:93</div></div>
<div class="ttc" id="ap4est__base_8h_html_a9f350ee78755ec6e7d25fb1dca474573"><div class="ttname"><a href="p4est__base_8h.html#a9f350ee78755ec6e7d25fb1dca474573">p4est_locidx_t</a></div><div class="ttdeci">int32_t p4est_locidx_t</div><div class="ttdoc">Typedef for processor-local indexing of quadrants and nodes.</div><div class="ttdef"><b>Definition:</b> p4est_base.h:106</div></div>
<div class="ttc" id="ap4est__base_8h_html_aab4b16aa58790d309e0cf46ed665c6b9"><div class="ttname"><a href="p4est__base_8h.html#aab4b16aa58790d309e0cf46ed665c6b9">p4est_init</a></div><div class="ttdeci">void p4est_init(sc_log_handler_t log_handler, int log_threshold)</div><div class="ttdoc">Registers p4est with the SC Library and sets the logging behavior.</div></div>
<div class="ttc" id="ap4est__bits_8h_html"><div class="ttname"><a href="p4est__bits_8h.html">p4est_bits.h</a></div><div class="ttdoc">Routines for manipulating quadrants (neighbors, parents, children, etc.)</div></div>
<div class="ttc" id="ap4est__bits_8h_html_a10f5aa2481ba7353f47cb9174e1cd4f6"><div class="ttname"><a href="p4est__bits_8h.html#a10f5aa2481ba7353f47cb9174e1cd4f6">p4est_coordinates_compare</a></div><div class="ttdeci">int p4est_coordinates_compare(const p4est_qcoord_t v1[], const p4est_qcoord_t v2[])</div><div class="ttdoc">Compare two sets of coordinates in their Morton ordering.</div></div>
<div class="ttc" id="ap4est__bits_8h_html_a1941e7d00d0d38d89865b4140c172a50"><div class="ttname"><a href="p4est__bits_8h.html#a1941e7d00d0d38d89865b4140c172a50">p4est_quadrant_is_node</a></div><div class="ttdeci">int p4est_quadrant_is_node(const p4est_quadrant_t *q, int inside)</div><div class="ttdoc">Test if a quadrant is used to represent a mesh node.</div></div>
<div class="ttc" id="ap4est__bits_8h_html_a1c0bd87bc88f3389fa5f224922ce060a"><div class="ttname"><a href="p4est__bits_8h.html#a1c0bd87bc88f3389fa5f224922ce060a">p4est_quadrant_volume_coordinates</a></div><div class="ttdeci">void p4est_quadrant_volume_coordinates(const p4est_quadrant_t *q, p4est_qcoord_t coords[])</div><div class="ttdoc">Compute the coordinates of a quadrant's midpoint.</div></div>
<div class="ttc" id="ap4est__bits_8h_html_a3d045f30f00319ac7410db08b8753a3e"><div class="ttname"><a href="p4est__bits_8h.html#a3d045f30f00319ac7410db08b8753a3e">p4est_quadrant_face_coordinates</a></div><div class="ttdeci">void p4est_quadrant_face_coordinates(const p4est_quadrant_t *q, int face, p4est_qcoord_t coords[])</div><div class="ttdoc">Compute the coordinates of a specific quadrant face's midpoint.</div></div>
<div class="ttc" id="ap4est__bits_8h_html_a571cd89e7cf1723a5d0702146d62a61f"><div class="ttname"><a href="p4est__bits_8h.html#a571cd89e7cf1723a5d0702146d62a61f">p4est_quadrant_root</a></div><div class="ttdeci">void p4est_quadrant_root(p4est_quadrant_t *root)</div><div class="ttdoc">Generate the root quadrant of any tree.</div></div>
<div class="ttc" id="ap4est__bits_8h_html_aa415031cb5088b5c1344b2421605c4c1"><div class="ttname"><a href="p4est__bits_8h.html#aa415031cb5088b5c1344b2421605c4c1">p4est_quadrant_corner_coordinates</a></div><div class="ttdeci">void p4est_quadrant_corner_coordinates(const p4est_quadrant_t *q, int corner, p4est_qcoord_t coords[])</div><div class="ttdoc">Compute the coordinates of a specific quadrant corner.</div></div>
<div class="ttc" id="ap4est__bits_8h_html_ada26b2e2ae47969c6a58a9fda446847f"><div class="ttname"><a href="p4est__bits_8h.html#ada26b2e2ae47969c6a58a9fda446847f">p4est_quadrant_corner_node</a></div><div class="ttdeci">void p4est_quadrant_corner_node(const p4est_quadrant_t *q, int corner, p4est_quadrant_t *r)</div><div class="ttdoc">Compute a corner node of a quadrant.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html"><div class="ttname"><a href="p4est__connectivity_8h.html">p4est_connectivity.h</a></div><div class="ttdoc">The connectivity defines the coarse topology of the forest.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a208e613cae5e1bd3baffb587387b672c"><div class="ttname"><a href="p4est__connectivity_8h.html#a208e613cae5e1bd3baffb587387b672c">p4est_connectivity_destroy</a></div><div class="ttdeci">void p4est_connectivity_destroy(p4est_connectivity_t *connectivity)</div><div class="ttdoc">Destroy a connectivity structure.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a2c4786e65053166a16b7afb2711d35cb"><div class="ttname"><a href="p4est__connectivity_8h.html#a2c4786e65053166a16b7afb2711d35cb">P4EST_DIM</a></div><div class="ttdeci">#define P4EST_DIM</div><div class="ttdoc">The spatial dimension.</div><div class="ttdef"><b>Definition:</b> p4est_connectivity.h:71</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a35a4816ff10305a61d0e749ec9888a6d"><div class="ttname"><a href="p4est__connectivity_8h.html#a35a4816ff10305a61d0e749ec9888a6d">p4est_connectivity_coordinates_canonicalize</a></div><div class="ttdeci">void p4est_connectivity_coordinates_canonicalize(p4est_connectivity_t *conn, p4est_topidx_t treeid, const p4est_qcoord_t coords[], p4est_topidx_t *treeid_out, p4est_qcoord_t coords_out[])</div><div class="ttdoc">Determine the owning tree for a coordinate and transform it there.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a3780b75fcd2a5b578c6dc294c4e77a5e"><div class="ttname"><a href="p4est__connectivity_8h.html#a3780b75fcd2a5b578c6dc294c4e77a5e">p4est_connectivity_is_valid</a></div><div class="ttdeci">int p4est_connectivity_is_valid(p4est_connectivity_t *connectivity)</div><div class="ttdoc">Examine a connectivity structure.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a69ad217418caeaf00fa92f492ab0faaa"><div class="ttname"><a href="p4est__connectivity_8h.html#a69ad217418caeaf00fa92f492ab0faaa">P4EST_FACES</a></div><div class="ttdeci">#define P4EST_FACES</div><div class="ttdoc">The number of faces of a quadrant.</div><div class="ttdef"><b>Definition:</b> p4est_connectivity.h:73</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_acb49ce9f7b688a2c6b6d62bda9ff5555"><div class="ttname"><a href="p4est__connectivity_8h.html#acb49ce9f7b688a2c6b6d62bda9ff5555">P4EST_CHILDREN</a></div><div class="ttdeci">#define P4EST_CHILDREN</div><div class="ttdoc">The number of children of a quadrant, also the number of corners.</div><div class="ttdef"><b>Definition:</b> p4est_connectivity.h:75</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_ad6fcb80b167783b7ab298755473c8177"><div class="ttname"><a href="p4est__connectivity_8h.html#ad6fcb80b167783b7ab298755473c8177">p4est_connectivity_new_corner</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_corner(void)</div><div class="ttdoc">Create a connectivity structure for a three-tree mesh around a corner.</div></div>
<div class="ttc" id="ap8est__bits_8h_html"><div class="ttname"><a href="p8est__bits_8h.html">p8est_bits.h</a></div><div class="ttdoc">Routines for manipulating quadrants (neighbors, parents, children, etc.)</div></div>
<div class="ttc" id="ap8est__bits_8h_html_a5f813e85958c05b884416e5909b6bedb"><div class="ttname"><a href="p8est__bits_8h.html#a5f813e85958c05b884416e5909b6bedb">p8est_quadrant_edge_coordinates</a></div><div class="ttdeci">void p8est_quadrant_edge_coordinates(const p8est_quadrant_t *q, int edge, p4est_qcoord_t coords[])</div><div class="ttdoc">Compute the coordinates of a specific quadrant edge's midpoint.</div></div>
<div class="ttc" id="ap8est__connectivity_8h_html"><div class="ttname"><a href="p8est__connectivity_8h.html">p8est_connectivity.h</a></div><div class="ttdoc">The connectivity defines the coarse topology of the forest.</div></div>
<div class="ttc" id="ap8est__connectivity_8h_html_ac88e4c055b8847d3c9074c17c624da6e"><div class="ttname"><a href="p8est__connectivity_8h.html#ac88e4c055b8847d3c9074c17c624da6e">p8est_connectivity_new_rotcubes</a></div><div class="ttdeci">p8est_connectivity_t * p8est_connectivity_new_rotcubes(void)</div><div class="ttdoc">Create a connectivity structure that contains a few cubes.</div></div>
<div class="ttc" id="ap8est__connectivity_8h_html_ad63a4ac1ac2795008bc8b9dd225bc3a2"><div class="ttname"><a href="p8est__connectivity_8h.html#ad63a4ac1ac2795008bc8b9dd225bc3a2">P8EST_EDGES</a></div><div class="ttdeci">#define P8EST_EDGES</div><div class="ttdoc">The number of edges around an octant.</div><div class="ttdef"><b>Definition:</b> p8est_connectivity.h:83</div></div>
<div class="ttc" id="astructp4est__connectivity_html"><div class="ttname"><a href="structp4est__connectivity.html">p4est_connectivity</a></div><div class="ttdoc">This structure holds the 2D inter-tree connectivity information.</div><div class="ttdef"><b>Definition:</b> p4est_connectivity.h:190</div></div>
<div class="ttc" id="astructp4est__connectivity_html_a1068e552922e0e98a1f2477020392b25"><div class="ttname"><a href="structp4est__connectivity.html#a1068e552922e0e98a1f2477020392b25">p4est_connectivity::num_trees</a></div><div class="ttdeci">p4est_topidx_t num_trees</div><div class="ttdoc">the number of trees</div><div class="ttdef"><b>Definition:</b> p4est_connectivity.h:194</div></div>
<div class="ttc" id="astructp4est__quadrant_html"><div class="ttname"><a href="structp4est__quadrant.html">p4est_quadrant</a></div><div class="ttdoc">The 2D quadrant datatype.</div><div class="ttdef"><b>Definition:</b> p4est.h:76</div></div>
<div class="ttc" id="astructp4est__quadrant_html_ad226034132b973fe7955ef797938dea0"><div class="ttname"><a href="structp4est__quadrant.html#ad226034132b973fe7955ef797938dea0">p4est_quadrant::y</a></div><div class="ttdeci">p4est_qcoord_t y</div><div class="ttdoc">coordinates</div><div class="ttdef"><b>Definition:</b> p4est.h:78</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/>
</body>
</html>
