<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>p4est: simple/simple2.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">p4est<span id="projectnumber">&#160;2.8.6</span>
   </div>
   <div id="projectbrief">p4est is a software library for parallel adaptive mesh refinement.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">simple/simple2.c</div></div>
</div><!--header-->
<div class="contents">
<p >This application generates, refines, and adjusts a mesh set on the command line.</p>
<p >This application generates, refines, and adjusts a mesh set on the command line.The resulting VTK files visually present each stage of the mesh modification procedure.</p>
<p >Usage: </p><blockquote class="doxtable">
<p >&zwj;<code>p4est_simple &lt;configuration&gt; &lt;level&gt;</code> possible configurations:</p><ul>
<li>unit Refinement on the unit square.</li>
<li>brick Refinement on a regular forest of octrees.</li>
<li>three Refinement on a forest with three trees.</li>
<li>evil Check second round of refinement with np=5 level=7</li>
<li>evil3 Check second round of refinement on three trees</li>
<li>pillow Refinement on a 2-tree pillow-shaped domain.</li>
<li>moebius Refinement on a 5-tree Moebius band.</li>
<li>star Refinement on a 6-tree star shaped domain.</li>
<li>cubed Refinement on a 6-tree cubed sphere surface.</li>
<li>disk Refinement on a 5-tree spherical standard disk.</li>
<li>xdisk Refinement on a 5-tree spherical disk periodic in x.</li>
<li>ydisk Refinement on a 5-tree spherical disk periodic in y.</li>
<li>pdisk Refinement on a 5-tree spherical disk, periodic b.c.</li>
<li>periodic Refinement on the unit square with all-periodic b.c.</li>
<li>rotwrap Refinement on the unit square with weird periodic b.c.</li>
<li>circle Refinement on a 6-tree donut-like circle.</li>
<li>drop Refinement on a 5-trees geometry with an inner hole.</li>
<li>icosahedron Refinement on the sphere</li>
<li>shell2d Refinement on a 2d shell with geometry.</li>
<li>disk2d Refinement on a 2d disk with geometry.</li>
<li>bowtie Refinement on a 2-tree bowtie domain. </li>
</ul>
</blockquote>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">  This file is part of p4est.</span></div>
<div class="line"><span class="comment">  p4est is a C library to manage a collection (a forest) of multiple</span></div>
<div class="line"><span class="comment">  connected adaptive quadtrees or octrees in parallel.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  Copyright (C) 2010 The University of Texas System</span></div>
<div class="line"><span class="comment">  Additional copyright (C) 2011 individual authors</span></div>
<div class="line"><span class="comment">  Written by Carsten Burstedde, Lucas C. Wilcox, and Tobin Isaac</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  p4est is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">  it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">  the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><span class="comment">  (at your option) any later version.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  p4est is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment">  GNU General Public License for more details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">  along with p4est; if not, write to the Free Software Foundation, Inc.,</span></div>
<div class="line"><span class="comment">  51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Usage: p4est_simple &lt;configuration&gt; &lt;level&gt;</span></div>
<div class="line"><span class="comment"> *        possible configurations:</span></div>
<div class="line"><span class="comment"> *        o unit      Refinement on the unit square.</span></div>
<div class="line"><span class="comment"> *        o brick     Refinement on a regular forest of octrees.</span></div>
<div class="line"><span class="comment"> *        o three     Refinement on a forest with three trees.</span></div>
<div class="line"><span class="comment"> *        o evil      Check second round of refinement with np=5 level=7</span></div>
<div class="line"><span class="comment"> *        o evil3     Check second round of refinement on three trees</span></div>
<div class="line"><span class="comment"> *        o pillow    Refinement on a 2-tree pillow-shaped domain.</span></div>
<div class="line"><span class="comment"> *        o moebius   Refinement on a 5-tree Moebius band.</span></div>
<div class="line"><span class="comment"> *        o star      Refinement on a 6-tree star shaped domain.</span></div>
<div class="line"><span class="comment"> *        o cubed     Refinement on a 6-tree cubed sphere surface.</span></div>
<div class="line"><span class="comment"> *        o disk      Refinement on a 5-tree spherical standard disk.</span></div>
<div class="line"><span class="comment"> *        o xdisk     Refinement on a 5-tree spherical disk periodic in x.</span></div>
<div class="line"><span class="comment"> *        o ydisk     Refinement on a 5-tree spherical disk periodic in y.</span></div>
<div class="line"><span class="comment"> *        o pdisk     Refinement on a 5-tree spherical disk, periodic b.c.</span></div>
<div class="line"><span class="comment"> *        o periodic  Refinement on the unit square with all-periodic b.c.</span></div>
<div class="line"><span class="comment"> *        o rotwrap   Refinement on the unit square with weird periodic b.c.</span></div>
<div class="line"><span class="comment"> *        o circle    Refinement on a 6-tree donut-like circle.</span></div>
<div class="line"><span class="comment"> *        o drop      Refinement on a 5-trees geometry with an inner hole.</span></div>
<div class="line"><span class="comment"> *        o icosahedron   Refinement on the icosahedron sphere with geometry.</span></div>
<div class="line"><span class="comment"> *        o shell2d       Refinement on a 2d shell with geometry.</span></div>
<div class="line"><span class="comment"> *        o disk2d        Refinement on a 2d disk with geometry.</span></div>
<div class="line"><span class="comment"> *        o bowtie    Refinement on a 2-tree bowtie domain.</span></div>
<div class="line"><span class="comment"> *        o sphere2d      Refinement on a 6-tree sphere surface with geometry.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="p4est__bits_8h.html">p4est_bits.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="p4est__extended_8h.html">p4est_extended.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="p4est__vtk_8h.html">p4est_vtk.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span></div>
<div class="line">{</div>
<div class="line">  P4EST_CONFIG_NULL,</div>
<div class="line">  P4EST_CONFIG_UNIT,</div>
<div class="line">  P4EST_CONFIG_BRICK,</div>
<div class="line">  P4EST_CONFIG_THREE,</div>
<div class="line">  P4EST_CONFIG_EVIL,</div>
<div class="line">  P4EST_CONFIG_EVIL3,</div>
<div class="line">  P4EST_CONFIG_PILLOW,</div>
<div class="line">  P4EST_CONFIG_MOEBIUS,</div>
<div class="line">  P4EST_CONFIG_STAR,</div>
<div class="line">  P4EST_CONFIG_CUBED,</div>
<div class="line">  P4EST_CONFIG_DISK,</div>
<div class="line">  P4EST_CONFIG_XDISK,</div>
<div class="line">  P4EST_CONFIG_YDISK,</div>
<div class="line">  P4EST_CONFIG_PDISK,</div>
<div class="line">  P4EST_CONFIG_PERIODIC,</div>
<div class="line">  P4EST_CONFIG_ROTWRAP,</div>
<div class="line">  P4EST_CONFIG_CIRCLE,</div>
<div class="line">  P4EST_CONFIG_DROP,</div>
<div class="line">  P4EST_CONFIG_ICOSAHEDRON,</div>
<div class="line">  P4EST_CONFIG_SHELL2D,</div>
<div class="line">  P4EST_CONFIG_DISK2D,</div>
<div class="line">  P4EST_CONFIG_BOWTIE,</div>
<div class="line">  P4EST_CONFIG_SPHERE2D,</div>
<div class="line">  P4EST_CONFIG_LAST</div>
<div class="line">}</div>
<div class="line">simple_config_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">  simple_config_t     config;</div>
<div class="line">  <span class="keywordtype">int</span>                 mpisize;</div>
<div class="line">  <span class="keywordtype">int</span>                 level;</div>
<div class="line">  <span class="keywordtype">unsigned</span>            checksum;</div>
<div class="line">}</div>
<div class="line">simple_regression_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">  <a class="code hl_typedef" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a>      a;</div>
<div class="line">}</div>
<div class="line">user_data_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">  sc_MPI_Comm         mpicomm;</div>
<div class="line">  <span class="keywordtype">int</span>                 mpisize;</div>
<div class="line">  <span class="keywordtype">int</span>                 mpirank;</div>
<div class="line">}</div>
<div class="line">mpi_context_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span>          refine_level = 0;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* *INDENT-OFF* */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> simple_regression_t regression[] =</div>
<div class="line">{{ P4EST_CONFIG_THREE, 1, 7, 0xa8d85863U },</div>
<div class="line"> { P4EST_CONFIG_THREE, 2, 7, 0xa8d85863U },</div>
<div class="line"> { P4EST_CONFIG_THREE, 3, 7, 0xa8d85863U },</div>
<div class="line"> { P4EST_CONFIG_THREE, 4, 7, 0x20fb58edU },</div>
<div class="line"> { P4EST_CONFIG_MOEBIUS, 1, 6, 0x98ab6cb2U },</div>
<div class="line"> { P4EST_CONFIG_MOEBIUS, 3, 6, 0x98ab6cb2U },</div>
<div class="line"> { P4EST_CONFIG_MOEBIUS, 5, 6, 0x98ab6cb2U },</div>
<div class="line"> { P4EST_CONFIG_MOEBIUS, 6, 6, 0x6d2d6d6cU },</div>
<div class="line"> { P4EST_CONFIG_STAR, 5, 6, 0x38d3736fU },</div>
<div class="line"> { P4EST_CONFIG_STAR, 5, 7, 0xfb97aadfU },</div>
<div class="line"> { P4EST_CONFIG_CUBED, 4, 3, 0x85581649U },</div>
<div class="line"> { P4EST_CONFIG_CUBED, 5, 5, 0x64a1d105U },</div>
<div class="line"> { P4EST_CONFIG_DISK, 5, 4, 0x4995411dU },</div>
<div class="line"> { P4EST_CONFIG_DISK, 2, 6, 0x3f758706U },</div>
<div class="line"> { P4EST_CONFIG_XDISK, 4, 4, 0x96324291 },</div>
<div class="line"> { P4EST_CONFIG_YDISK, 4, 4, 0x752a4207 },</div>
<div class="line"> { P4EST_CONFIG_PDISK, 4, 4, 0xf617437b },</div>
<div class="line"> { P4EST_CONFIG_PDISK, 5, 5, 0x507fd0c9 },</div>
<div class="line"> { P4EST_CONFIG_ROTWRAP, 1, 6, 0x9dd600c5U },</div>
<div class="line"> { P4EST_CONFIG_ROTWRAP, 3, 6, 0x9dd600c5U },</div>
<div class="line"> { P4EST_CONFIG_CIRCLE, 3, 6, 0xd6e4931b },</div>
<div class="line"> { P4EST_CONFIG_DROP, 3, 6, 0xea6a6726 },</div>
<div class="line"> { P4EST_CONFIG_BOWTIE, 1, 3, 0x63ba0805 },</div>
<div class="line"> { P4EST_CONFIG_NULL, 0, 0, 0 }};</div>
<div class="line"><span class="comment">/* *INDENT-ON* */</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">init_fn (<a id="_a0" name="_a0"></a><a class="code hl_struct" href="structp4est.html">p4est_t</a> * <a class="code hl_struct" href="structp4est.html">p4est</a>, <a class="code hl_typedef" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree,</div>
<div class="line">         <a id="_a1" name="_a1"></a><a class="code hl_struct" href="structp4est__quadrant.html">p4est_quadrant_t</a> * quadrant)</div>
<div class="line">{</div>
<div class="line">  user_data_t        *data = (user_data_t *) quadrant-&gt;<a id="a2" name="a2"></a><a class="code hl_variable" href="structp4est__quadrant.html#a84896efd4c9ace3225253e379fb48a6e">p</a>.<a id="a3" name="a3"></a><a class="code hl_variable" href="unionp4est__quadrant_1_1p4est__quadrant__data.html#aff6684573d249ebf6af9f035aff5e1a0">user_data</a>;</div>
<div class="line"> </div>
<div class="line">  data-&gt;a = which_tree;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">refine_normal_fn (<a class="code hl_struct" href="structp4est.html">p4est_t</a> * <a class="code hl_struct" href="structp4est.html">p4est</a>, <a class="code hl_typedef" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree,</div>
<div class="line">                  <a class="code hl_struct" href="structp4est__quadrant.html">p4est_quadrant_t</a> * quadrant)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) quadrant-&gt;<a id="a4" name="a4"></a><a class="code hl_variable" href="structp4est__quadrant.html#a0f92ad9bd71d9e3f82246d2768ff23ad">level</a> &gt;= (refine_level - (<span class="keywordtype">int</span>) (which_tree % 3))) {</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (quadrant-&gt;<a class="code hl_variable" href="structp4est__quadrant.html#a0f92ad9bd71d9e3f82246d2768ff23ad">level</a> == 1 &amp;&amp; <a id="a5" name="a5"></a><a class="code hl_function" href="p4est__bits_8h.html#a2b0cbbd87c0bc9d640fb0ee8b32d9a0f">p4est_quadrant_child_id</a> (quadrant) == 3) {</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (quadrant-&gt;<a id="a6" name="a6"></a>x == <a id="a7" name="a7"></a><a class="code hl_define" href="p4est_8h.html#a749010ab0282ddc94751375f5f6692a6">P4EST_LAST_OFFSET</a> (2) &amp;&amp;</div>
<div class="line">      quadrant-&gt;<a id="a8" name="a8"></a><a class="code hl_variable" href="structp4est__quadrant.html#ad226034132b973fe7955ef797938dea0">y</a> == <a class="code hl_define" href="p4est_8h.html#a749010ab0282ddc94751375f5f6692a6">P4EST_LAST_OFFSET</a> (2)) {</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (quadrant-&gt;x &gt;= <a id="a9" name="a9"></a><a class="code hl_define" href="p4est_8h.html#a95dd59166894e55562dd7bb741bb78c5">P4EST_QUADRANT_LEN</a> (2)) {</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">refine_evil_fn (<a class="code hl_struct" href="structp4est.html">p4est_t</a> * <a class="code hl_struct" href="structp4est.html">p4est</a>, <a class="code hl_typedef" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree,</div>
<div class="line">                <a class="code hl_struct" href="structp4est__quadrant.html">p4est_quadrant_t</a> * quadrant)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) quadrant-&gt;<a class="code hl_variable" href="structp4est__quadrant.html#a0f92ad9bd71d9e3f82246d2768ff23ad">level</a> &gt;= refine_level) {</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structp4est.html">p4est</a>-&gt;<a id="a10" name="a10"></a><a class="code hl_variable" href="structp4est.html#a5b7b11eb9050eede87019bdb831a20b3">mpirank</a> &lt;= 1) {</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">refine_evil3_fn (<a class="code hl_struct" href="structp4est.html">p4est_t</a> * <a class="code hl_struct" href="structp4est.html">p4est</a>, <a class="code hl_typedef" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree,</div>
<div class="line">                 <a class="code hl_struct" href="structp4est__quadrant.html">p4est_quadrant_t</a> * quadrant)</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_typedef" href="p4est__base_8h.html#a05ea8ceb664ae2403fbcf7b1dcc70ea0">p4est_qcoord_t</a>      u2;</div>
<div class="line">  <a class="code hl_struct" href="structp4est__quadrant.html">p4est_quadrant_t</a>    ref;</div>
<div class="line"> </div>
<div class="line">  <a id="a11" name="a11"></a><a class="code hl_define" href="p4est_8h.html#a75e2346ceb308d8a9cd540d5d7a63715">P4EST_QUADRANT_INIT</a> (&amp;ref);</div>
<div class="line"> </div>
<div class="line">  u2 = <a class="code hl_define" href="p4est_8h.html#a95dd59166894e55562dd7bb741bb78c5">P4EST_QUADRANT_LEN</a> (2);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (which_tree == 0) {</div>
<div class="line">    ref.x = 3 * u2;</div>
<div class="line">    ref.<a class="code hl_variable" href="structp4est__quadrant.html#ad226034132b973fe7955ef797938dea0">y</a> = 2 * u2;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (which_tree == 1) {</div>
<div class="line">    ref.x = 2 * u2;</div>
<div class="line">    ref.<a class="code hl_variable" href="structp4est__quadrant.html#ad226034132b973fe7955ef797938dea0">y</a> = 3 * u2;</div>
<div class="line">  }</div>
<div class="line">  ref.<a class="code hl_variable" href="structp4est__quadrant.html#a0f92ad9bd71d9e3f82246d2768ff23ad">level</a> = 2;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) quadrant-&gt;<a class="code hl_variable" href="structp4est__quadrant.html#a0f92ad9bd71d9e3f82246d2768ff23ad">level</a> &gt;= refine_level) {</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> ((which_tree == 0 || which_tree == 1) &amp;&amp;</div>
<div class="line">      (<a id="a12" name="a12"></a><a class="code hl_function" href="p4est__bits_8h.html#a78be9585dd09db13844006c2ea69c0d8">p4est_quadrant_is_equal</a> (&amp;ref, quadrant) ||</div>
<div class="line">       <a id="a13" name="a13"></a><a class="code hl_function" href="p4est__bits_8h.html#a280866adc8089fa7117c08304c950ef4">p4est_quadrant_is_ancestor</a> (&amp;ref, quadrant))) {</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">coarsen_evil_fn (<a class="code hl_struct" href="structp4est.html">p4est_t</a> * <a class="code hl_struct" href="structp4est.html">p4est</a>, <a class="code hl_typedef" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree,</div>
<div class="line">                 <a class="code hl_struct" href="structp4est__quadrant.html">p4est_quadrant_t</a> * q[])</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structp4est.html">p4est</a>-&gt;<a class="code hl_variable" href="structp4est.html#a5b7b11eb9050eede87019bdb831a20b3">mpirank</a> &gt;= 2) {</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">refine_icosahedron_fn (<a class="code hl_struct" href="structp4est.html">p4est_t</a> * <a class="code hl_struct" href="structp4est.html">p4est</a>, <a class="code hl_typedef" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree,</div>
<div class="line">                       <a class="code hl_struct" href="structp4est__quadrant.html">p4est_quadrant_t</a> * quadrant)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line">  <a id="_a14" name="_a14"></a><a class="code hl_struct" href="structp4est__geometry.html">p4est_geometry_t</a>   *geom = (<a class="code hl_struct" href="structp4est__geometry.html">p4est_geometry_t</a> *) <a class="code hl_struct" href="structp4est.html">p4est</a>-&gt;<a id="a15" name="a15"></a><a class="code hl_variable" href="structp4est.html#a486eacc9c8e6ce28ff34429d297e703f">user_pointer</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* logical coordinates */</span></div>
<div class="line">  <span class="keywordtype">double</span>              xyz[3] = { 0, 0, 0 };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* physical coordinates */</span></div>
<div class="line">  <span class="keywordtype">double</span>              XYZ[3] = { 0, 0, 0 };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span>              h2 =</div>
<div class="line">    0.5 * <a class="code hl_define" href="p4est_8h.html#a95dd59166894e55562dd7bb741bb78c5">P4EST_QUADRANT_LEN</a> (quadrant-&gt;<a class="code hl_variable" href="structp4est__quadrant.html#a0f92ad9bd71d9e3f82246d2768ff23ad">level</a>) / <a id="a16" name="a16"></a><a class="code hl_define" href="p4est_8h.html#ae26167f0411d9845caa84be6d50c0cee">P4EST_ROOT_LEN</a>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span>        intsize = 1.0 / <a class="code hl_define" href="p4est_8h.html#ae26167f0411d9845caa84be6d50c0cee">P4EST_ROOT_LEN</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * get coordinates at cell center</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  xyz[0] = intsize * quadrant-&gt;x + h2;</div>
<div class="line">  xyz[1] = intsize * quadrant-&gt;<a class="code hl_variable" href="structp4est__quadrant.html#ad226034132b973fe7955ef797938dea0">y</a> + h2;</div>
<div class="line"><span class="preprocessor">#ifdef P4_TO_P8</span></div>
<div class="line">  xyz[2] = intsize * quadrant-&gt;z + h2;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* from logical coordinates to physical coordinates (cartesian) */</span></div>
<div class="line">  geom-&gt;X (geom, which_tree, xyz, XYZ);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (quadrant-&gt;<a class="code hl_variable" href="structp4est__quadrant.html#a0f92ad9bd71d9e3f82246d2768ff23ad">level</a> &gt; 6)</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  <span class="keywordflow">if</span> (XYZ[2] &gt; 0 &amp;&amp; quadrant-&gt;<a class="code hl_variable" href="structp4est__quadrant.html#a0f92ad9bd71d9e3f82246d2768ff23ad">level</a> &gt;= 3)</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span>                 mpiret;</div>
<div class="line">  <span class="keywordtype">int</span>                 wrongusage;</div>
<div class="line">  <span class="keywordtype">unsigned</span>            crc;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>         *usage;</div>
<div class="line">  mpi_context_t       mpi_context, *mpi = &amp;mpi_context;</div>
<div class="line">  <a class="code hl_struct" href="structp4est.html">p4est_t</a>            *<a class="code hl_struct" href="structp4est.html">p4est</a>;</div>
<div class="line">  <a id="_a17" name="_a17"></a><a class="code hl_struct" href="structp4est__connectivity.html">p4est_connectivity_t</a> *connectivity;</div>
<div class="line">  <a class="code hl_struct" href="structp4est__geometry.html">p4est_geometry_t</a>   *geom;</div>
<div class="line">  <a id="a18" name="a18"></a><a class="code hl_typedef" href="p4est_8h.html#ad6f6d433abde78f20ea267e6aebea26a">p4est_refine_t</a>      refine_fn;</div>
<div class="line">  <a id="a19" name="a19"></a><a class="code hl_typedef" href="p4est_8h.html#a07f6ccd747245d55e33f1668854316a2">p4est_coarsen_t</a>     coarsen_fn;</div>
<div class="line">  simple_config_t     config;</div>
<div class="line">  <span class="keyword">const</span> simple_regression_t *r;</div>
<div class="line">  <span class="keywordtype">int</span>                 nbrick_x = 1, nbrick_y = 1;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* initialize MPI and p4est internals */</span></div>
<div class="line">  mpiret = sc_MPI_Init (&amp;argc, &amp;argv);</div>
<div class="line">  SC_CHECK_MPI (mpiret);</div>
<div class="line">  mpi-&gt;mpicomm = sc_MPI_COMM_WORLD;</div>
<div class="line">  mpiret = sc_MPI_Comm_size (mpi-&gt;mpicomm, &amp;mpi-&gt;mpisize);</div>
<div class="line">  SC_CHECK_MPI (mpiret);</div>
<div class="line">  mpiret = sc_MPI_Comm_rank (mpi-&gt;mpicomm, &amp;mpi-&gt;mpirank);</div>
<div class="line">  SC_CHECK_MPI (mpiret);</div>
<div class="line"> </div>
<div class="line">  sc_init (mpi-&gt;mpicomm, 1, 1, NULL, SC_LP_DEFAULT);</div>
<div class="line">  <a id="a20" name="a20"></a><a class="code hl_function" href="p4est__base_8h.html#aab4b16aa58790d309e0cf46ed665c6b9">p4est_init</a> (NULL, SC_LP_DEFAULT);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* process command line arguments */</span></div>
<div class="line">  usage =</div>
<div class="line">    <span class="stringliteral">&quot;Arguments: &lt;configuration&gt; &lt;level&gt;\n&quot;</span></div>
<div class="line">    <span class="stringliteral">&quot;   Configuration can be any of\n&quot;</span></div>
<div class="line">    <span class="stringliteral">&quot;      unit|brick|three|evil|evil3|pillow|moebius|\n&quot;</span></div>
<div class="line">    <span class="stringliteral">&quot;         star|cubed|disk|xdisk|ydisk|pdisk|periodic|\n&quot;</span></div>
<div class="line">    <span class="stringliteral">&quot;         rotwrap|circle|drop|icosahedron|shell2d|disk2d|bowtie|sphere2d\n&quot;</span></div>
<div class="line">    <span class="stringliteral">&quot;   Level controls the maximum depth of refinement\n&quot;</span>;</div>
<div class="line">  wrongusage = 0;</div>
<div class="line">  config = P4EST_CONFIG_NULL;</div>
<div class="line">  <span class="keywordflow">if</span> (!wrongusage &amp;&amp; argc &lt; 3) {</div>
<div class="line">    wrongusage = 1;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (!wrongusage) {</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;unit&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_UNIT;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;brick&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_BRICK;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;three&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_THREE;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;evil&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_EVIL;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;evil3&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_EVIL3;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;pillow&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_PILLOW;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;moebius&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_MOEBIUS;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;star&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_STAR;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;cubed&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_CUBED;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;disk&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_DISK;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;xdisk&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_XDISK;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;ydisk&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_YDISK;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;pdisk&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_PDISK;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;periodic&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_PERIODIC;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;rotwrap&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_ROTWRAP;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;circle&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_CIRCLE;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;drop&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_DROP;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;icosahedron&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_ICOSAHEDRON;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;shell2d&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_SHELL2D;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;disk2d&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_DISK2D;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;bowtie&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_BOWTIE;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp (argv[1], <span class="stringliteral">&quot;sphere2d&quot;</span>)) {</div>
<div class="line">      config = P4EST_CONFIG_SPHERE2D;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">      wrongusage = 1;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (wrongusage) {</div>
<div class="line">    P4EST_GLOBAL_LERROR (usage);</div>
<div class="line">    sc_abort_collective (<span class="stringliteral">&quot;Usage error&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* assign variables based on configuration */</span></div>
<div class="line">  refine_level = atoi (argv[2]);</div>
<div class="line">  <span class="keywordflow">if</span> (config == P4EST_CONFIG_EVIL) {</div>
<div class="line">    refine_fn = refine_evil_fn;</div>
<div class="line">    coarsen_fn = coarsen_evil_fn;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_EVIL3) {</div>
<div class="line">    refine_fn = refine_evil3_fn;</div>
<div class="line">    coarsen_fn = NULL;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_ICOSAHEDRON) {</div>
<div class="line">    refine_fn = refine_icosahedron_fn;</div>
<div class="line">    coarsen_fn = NULL;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    refine_fn = refine_normal_fn;</div>
<div class="line">    coarsen_fn = NULL;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* create connectivity and forest structures */</span></div>
<div class="line">  geom = NULL;</div>
<div class="line">  <span class="keywordflow">if</span> (config == P4EST_CONFIG_BRICK) {</div>
<div class="line">    nbrick_x = argc &gt; 3 ? atoi (argv[3]) : 3;</div>
<div class="line">    nbrick_y = argc &gt; 4 ? atoi (argv[4]) : 2;</div>
<div class="line">    connectivity = <a id="a21" name="a21"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a4d767547ff8aae4a453c2e96ebce9918">p4est_connectivity_new_brick</a> (nbrick_x, nbrick_y, 0, 0);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_THREE || config == P4EST_CONFIG_EVIL3) {</div>
<div class="line">    connectivity = <a id="a22" name="a22"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a0fd421c8379a095e89ad804c0c12e971">p4est_connectivity_new_corner</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_PILLOW) {</div>
<div class="line">    connectivity = <a id="a23" name="a23"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a63201cf8e928e60ce884ebdbe13730ee">p4est_connectivity_new_pillow</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_MOEBIUS) {</div>
<div class="line">    connectivity = <a id="a24" name="a24"></a><a class="code hl_function" href="p4est__connectivity_8h.html#ae6564b782958454d9bc3ed02b23ae627">p4est_connectivity_new_moebius</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_STAR) {</div>
<div class="line">    connectivity = <a id="a25" name="a25"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a7fd7fb1c260d827d7e64a2cbe562bf27">p4est_connectivity_new_star</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_CUBED) {</div>
<div class="line">    connectivity = <a id="a26" name="a26"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a12894fe664f1f5607ff94aef7893339e">p4est_connectivity_new_cubed</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_DISK) {</div>
<div class="line">    connectivity = <a id="a27" name="a27"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a28ee3ef55210cd2b88cefced9ac14f70">p4est_connectivity_new_disk</a> (0, 0);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_XDISK) {</div>
<div class="line">    connectivity = <a class="code hl_function" href="p4est__connectivity_8h.html#a28ee3ef55210cd2b88cefced9ac14f70">p4est_connectivity_new_disk</a> (1, 0);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_YDISK) {</div>
<div class="line">    connectivity = <a class="code hl_function" href="p4est__connectivity_8h.html#a28ee3ef55210cd2b88cefced9ac14f70">p4est_connectivity_new_disk</a> (0, 1);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_PDISK) {</div>
<div class="line">    connectivity = <a class="code hl_function" href="p4est__connectivity_8h.html#a28ee3ef55210cd2b88cefced9ac14f70">p4est_connectivity_new_disk</a> (1, 1);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_PERIODIC) {</div>
<div class="line">    connectivity = <a id="a28" name="a28"></a><a class="code hl_function" href="p4est__connectivity_8h.html#aeec450942d8ceb63c8a26e217846838b">p4est_connectivity_new_periodic</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_ROTWRAP) {</div>
<div class="line">    connectivity = <a id="a29" name="a29"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a3a17dfaa5e0f668db6e2ab79b7d906fe">p4est_connectivity_new_rotwrap</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_CIRCLE) {</div>
<div class="line">    connectivity = <a id="a30" name="a30"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a4fb8c54e19a1b8843f7d6b92b579c0bd">p4est_connectivity_new_circle</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_DROP) {</div>
<div class="line">    connectivity = <a id="a31" name="a31"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a04e5eba4d0b5de6286228b43171c3237">p4est_connectivity_new_drop</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_ICOSAHEDRON) {</div>
<div class="line">    <span class="keywordtype">double</span>              R = 1.0;        <span class="comment">/* sphere radius default value */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (argc &gt;= 4)</div>
<div class="line">      R = atof (argv[3]);</div>
<div class="line"> </div>
<div class="line">    connectivity = <a id="a32" name="a32"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a77bccda549718827993b5790ca79a509">p4est_connectivity_new_icosahedron</a> ();</div>
<div class="line">    geom = <a id="a33" name="a33"></a><a class="code hl_function" href="p4est__geometry_8h.html#a6db4e8809e2bde8a76ce2edfacc0ca50">p4est_geometry_new_icosahedron</a> (connectivity, R);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_SHELL2D) {</div>
<div class="line">    connectivity = <a id="a34" name="a34"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a3613c1c140e3475b184d7f96af5c2ef3">p4est_connectivity_new_shell2d</a> ();</div>
<div class="line">    geom = <a id="a35" name="a35"></a><a class="code hl_function" href="p4est__geometry_8h.html#a196bb1ad3a9ccab822675609e46395cc">p4est_geometry_new_shell2d</a> (connectivity, 1., 0.55);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_DISK2D) {</div>
<div class="line">    connectivity = <a id="a36" name="a36"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a360c55d8055be2c0a8984ccd71cb5cd6">p4est_connectivity_new_disk2d</a> ();</div>
<div class="line">    geom = <a id="a37" name="a37"></a><a class="code hl_function" href="p4est__geometry_8h.html#a291fa1714141de267265cf1591009fe7">p4est_geometry_new_disk2d</a> (connectivity, 0.44, 1.0);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_BOWTIE) {</div>
<div class="line">    connectivity = <a id="a38" name="a38"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a7bc5f541b475afbfa6cb997587d49ec7">p4est_connectivity_new_bowtie</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == P4EST_CONFIG_SPHERE2D) {</div>
<div class="line">    connectivity = <a class="code hl_function" href="p4est__connectivity_8h.html#a12894fe664f1f5607ff94aef7893339e">p4est_connectivity_new_cubed</a> ();</div>
<div class="line">    geom = <a id="a39" name="a39"></a><a class="code hl_function" href="p4est__geometry_8h.html#a1ca45d79b5883113280368706ac45164">p4est_geometry_new_sphere2d</a> (connectivity, 1.0);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    connectivity = <a id="a40" name="a40"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a3405dfcd7ac8f55a1f792fc011bd72c9">p4est_connectivity_new_unitsquare</a> ();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* create forest data structure */</span></div>
<div class="line">  P4EST_GLOBAL_PRODUCTIONF (<span class="stringliteral">&quot;Size of one quadrant: %d bytes\n&quot;</span>,</div>
<div class="line">                            (<span class="keywordtype">int</span>) <span class="keyword">sizeof</span> (<a class="code hl_struct" href="structp4est__quadrant.html">p4est_quadrant_t</a>));</div>
<div class="line">  <a class="code hl_struct" href="structp4est.html">p4est</a> = <a id="a41" name="a41"></a><a class="code hl_function" href="p4est__extended_8h.html#a59df906152ad91e56010e3f3bda991f0">p4est_new_ext</a> (mpi-&gt;mpicomm, connectivity, 15, 0, 0,</div>
<div class="line">                         sizeof (user_data_t), init_fn, geom);</div>
<div class="line">  <a id="a42" name="a42"></a><a class="code hl_function" href="p4est__vtk_8h.html#a9e8a44b027b5372824a2c1ef2c17dea8">p4est_vtk_write_file</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>, geom, <span class="stringliteral">&quot;simple2_new&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* refinement and coarsening */</span></div>
<div class="line">  <a id="a43" name="a43"></a><a class="code hl_function" href="p4est_8h.html#a1a31375edfa42b5609e7656233c32cca">p4est_refine</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>, 1, refine_fn, init_fn);</div>
<div class="line">  <span class="keywordflow">if</span> (coarsen_fn != NULL) {</div>
<div class="line">    <a id="a44" name="a44"></a><a class="code hl_function" href="p4est_8h.html#ad250f4765d9778ec3940e9fabea7c853">p4est_coarsen</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>, 1, coarsen_fn, init_fn);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_function" href="p4est__vtk_8h.html#a9e8a44b027b5372824a2c1ef2c17dea8">p4est_vtk_write_file</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>, geom, <span class="stringliteral">&quot;simple2_refined&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* balance */</span></div>
<div class="line">  <a id="a45" name="a45"></a><a class="code hl_function" href="p4est_8h.html#a6b603736cf5007b14755197a9c179a85">p4est_balance</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>, <a id="a46" name="a46"></a><a class="code hl_enumvalue" href="p4est__connectivity_8h.html#adc5f6166fc408c325589ce3e620552caa5bf35c11d90c02cb481e9edadb51bda7">P4EST_CONNECT_FULL</a>, init_fn);</div>
<div class="line">  <a class="code hl_function" href="p4est__vtk_8h.html#a9e8a44b027b5372824a2c1ef2c17dea8">p4est_vtk_write_file</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>, geom, <span class="stringliteral">&quot;simple2_balanced&quot;</span>);</div>
<div class="line">  crc = <a id="a47" name="a47"></a><a class="code hl_function" href="p4est_8h.html#ad1e90b05434a0cf76f1f44af7f72ef66">p4est_checksum</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* partition */</span></div>
<div class="line">  <a id="a48" name="a48"></a><a class="code hl_function" href="p4est_8h.html#a54c1f4e6bc35c181952371a8046523aa">p4est_partition</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>, 0, NULL);</div>
<div class="line">  <a class="code hl_function" href="p4est__vtk_8h.html#a9e8a44b027b5372824a2c1ef2c17dea8">p4est_vtk_write_file</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>, geom, <span class="stringliteral">&quot;simple2_partition&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef P4EST_ENABLE_DEBUG</span></div>
<div class="line">  <span class="comment">/* rebalance should not change checksum */</span></div>
<div class="line">  <a class="code hl_function" href="p4est_8h.html#a6b603736cf5007b14755197a9c179a85">p4est_balance</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>, <a class="code hl_enumvalue" href="p4est__connectivity_8h.html#adc5f6166fc408c325589ce3e620552caa5bf35c11d90c02cb481e9edadb51bda7">P4EST_CONNECT_FULL</a>, init_fn);</div>
<div class="line">  P4EST_ASSERT (<a class="code hl_function" href="p4est_8h.html#ad1e90b05434a0cf76f1f44af7f72ef66">p4est_checksum</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>) == crc);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* print and verify forest checksum */</span></div>
<div class="line">  P4EST_GLOBAL_STATISTICSF (<span class="stringliteral">&quot;Tree checksum 0x%08x\n&quot;</span>, crc);</div>
<div class="line">  <span class="keywordflow">if</span> (mpi-&gt;mpirank == 0) {</div>
<div class="line">    <span class="keywordflow">for</span> (r = regression; r-&gt;config != P4EST_CONFIG_NULL; ++r) {</div>
<div class="line">      <span class="keywordflow">if</span> (r-&gt;config != config || r-&gt;mpisize != mpi-&gt;mpisize</div>
<div class="line">          || r-&gt;level != refine_level)</div>
<div class="line">        <span class="keywordflow">continue</span>;</div>
<div class="line">      SC_CHECK_ABORT (crc == r-&gt;checksum, <span class="stringliteral">&quot;Checksum mismatch&quot;</span>);</div>
<div class="line">      P4EST_GLOBAL_INFO (<span class="stringliteral">&quot;Checksum regression OK\n&quot;</span>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* destroy the p4est and its connectivity structure */</span></div>
<div class="line">  <a id="a49" name="a49"></a><a class="code hl_function" href="p4est_8h.html#a1e78f347378fe8b097ef019214f2338e">p4est_destroy</a> (<a class="code hl_struct" href="structp4est.html">p4est</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (geom != NULL) {</div>
<div class="line">    <a id="a50" name="a50"></a><a class="code hl_function" href="p4est__geometry_8h.html#ad389d94045e366e64a0c7854739f1f8f">p4est_geometry_destroy</a> (geom);</div>
<div class="line">  }</div>
<div class="line">  <a id="a51" name="a51"></a><a class="code hl_function" href="p4est__connectivity_8h.html#a208e613cae5e1bd3baffb587387b672c">p4est_connectivity_destroy</a> (connectivity);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* clean up and exit */</span></div>
<div class="line">  sc_finalize ();</div>
<div class="line"> </div>
<div class="line">  mpiret = sc_MPI_Finalize ();</div>
<div class="line">  SC_CHECK_MPI (mpiret);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="ap4est_8h_html_a07f6ccd747245d55e33f1668854316a2"><div class="ttname"><a href="p4est_8h.html#a07f6ccd747245d55e33f1668854316a2">p4est_coarsen_t</a></div><div class="ttdeci">int(* p4est_coarsen_t)(p4est_t *p4est, p4est_topidx_t which_tree, p4est_quadrant_t *quadrants[])</div><div class="ttdoc">Callback function prototype to decide for coarsening.</div><div class="ttdef"><b>Definition:</b> p4est.h:223</div></div>
<div class="ttc" id="ap4est_8h_html_a1a31375edfa42b5609e7656233c32cca"><div class="ttname"><a href="p4est_8h.html#a1a31375edfa42b5609e7656233c32cca">p4est_refine</a></div><div class="ttdeci">void p4est_refine(p4est_t *p4est, int refine_recursive, p4est_refine_t refine_fn, p4est_init_t init_fn)</div><div class="ttdoc">Refine a forest.</div></div>
<div class="ttc" id="ap4est_8h_html_a1e78f347378fe8b097ef019214f2338e"><div class="ttname"><a href="p4est_8h.html#a1e78f347378fe8b097ef019214f2338e">p4est_destroy</a></div><div class="ttdeci">void p4est_destroy(p4est_t *p4est)</div><div class="ttdoc">Destroy a p4est.</div></div>
<div class="ttc" id="ap4est_8h_html_a54c1f4e6bc35c181952371a8046523aa"><div class="ttname"><a href="p4est_8h.html#a54c1f4e6bc35c181952371a8046523aa">p4est_partition</a></div><div class="ttdeci">void p4est_partition(p4est_t *p4est, int allow_for_coarsening, p4est_weight_t weight_fn)</div><div class="ttdoc">Equally partition the forest.</div></div>
<div class="ttc" id="ap4est_8h_html_a6b603736cf5007b14755197a9c179a85"><div class="ttname"><a href="p4est_8h.html#a6b603736cf5007b14755197a9c179a85">p4est_balance</a></div><div class="ttdeci">void p4est_balance(p4est_t *p4est, p4est_connect_type_t btype, p4est_init_t init_fn)</div><div class="ttdoc">2:1 balance the size differences of neighboring elements in a forest.</div></div>
<div class="ttc" id="ap4est_8h_html_a749010ab0282ddc94751375f5f6692a6"><div class="ttname"><a href="p4est_8h.html#a749010ab0282ddc94751375f5f6692a6">P4EST_LAST_OFFSET</a></div><div class="ttdeci">#define P4EST_LAST_OFFSET(l)</div><div class="ttdoc">The offset of the highest (farthest from the origin) quadrant at level l.</div><div class="ttdef"><b>Definition:</b> p4est.h:68</div></div>
<div class="ttc" id="ap4est_8h_html_a75e2346ceb308d8a9cd540d5d7a63715"><div class="ttname"><a href="p4est_8h.html#a75e2346ceb308d8a9cd540d5d7a63715">P4EST_QUADRANT_INIT</a></div><div class="ttdeci">#define P4EST_QUADRANT_INIT(q)</div><div class="ttdoc">set statically allocated quadrant to defined values</div><div class="ttdef"><b>Definition:</b> p4est.h:240</div></div>
<div class="ttc" id="ap4est_8h_html_a95dd59166894e55562dd7bb741bb78c5"><div class="ttname"><a href="p4est_8h.html#a95dd59166894e55562dd7bb741bb78c5">P4EST_QUADRANT_LEN</a></div><div class="ttdeci">#define P4EST_QUADRANT_LEN(l)</div><div class="ttdoc">The length of a quadrant of level l.</div><div class="ttdef"><b>Definition:</b> p4est.h:61</div></div>
<div class="ttc" id="ap4est_8h_html_ad1e90b05434a0cf76f1f44af7f72ef66"><div class="ttname"><a href="p4est_8h.html#ad1e90b05434a0cf76f1f44af7f72ef66">p4est_checksum</a></div><div class="ttdeci">unsigned p4est_checksum(p4est_t *p4est)</div><div class="ttdoc">Compute the checksum for a forest.</div></div>
<div class="ttc" id="ap4est_8h_html_ad250f4765d9778ec3940e9fabea7c853"><div class="ttname"><a href="p4est_8h.html#ad250f4765d9778ec3940e9fabea7c853">p4est_coarsen</a></div><div class="ttdeci">void p4est_coarsen(p4est_t *p4est, int coarsen_recursive, p4est_coarsen_t coarsen_fn, p4est_init_t init_fn)</div><div class="ttdoc">Coarsen a forest.</div></div>
<div class="ttc" id="ap4est_8h_html_ad6f6d433abde78f20ea267e6aebea26a"><div class="ttname"><a href="p4est_8h.html#ad6f6d433abde78f20ea267e6aebea26a">p4est_refine_t</a></div><div class="ttdeci">int(* p4est_refine_t)(p4est_t *p4est, p4est_topidx_t which_tree, p4est_quadrant_t *quadrant)</div><div class="ttdoc">Callback function prototype to decide for refinement.</div><div class="ttdef"><b>Definition:</b> p4est.h:213</div></div>
<div class="ttc" id="ap4est_8h_html_ae26167f0411d9845caa84be6d50c0cee"><div class="ttname"><a href="p4est_8h.html#ae26167f0411d9845caa84be6d50c0cee">P4EST_ROOT_LEN</a></div><div class="ttdeci">#define P4EST_ROOT_LEN</div><div class="ttdoc">The length of a side of the root quadrant.</div><div class="ttdef"><b>Definition:</b> p4est.h:58</div></div>
<div class="ttc" id="ap4est__base_8h_html_a05ea8ceb664ae2403fbcf7b1dcc70ea0"><div class="ttname"><a href="p4est__base_8h.html#a05ea8ceb664ae2403fbcf7b1dcc70ea0">p4est_qcoord_t</a></div><div class="ttdeci">int32_t p4est_qcoord_t</div><div class="ttdoc">Typedef for quadrant coordinates.</div><div class="ttdef"><b>Definition:</b> p4est_base.h:81</div></div>
<div class="ttc" id="ap4est__base_8h_html_a8e849f705b0d4d1702b8f5102823f48c"><div class="ttname"><a href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a></div><div class="ttdeci">int32_t p4est_topidx_t</div><div class="ttdoc">Typedef for counting topological entities (trees, tree vertices).</div><div class="ttdef"><b>Definition:</b> p4est_base.h:93</div></div>
<div class="ttc" id="ap4est__base_8h_html_aab4b16aa58790d309e0cf46ed665c6b9"><div class="ttname"><a href="p4est__base_8h.html#aab4b16aa58790d309e0cf46ed665c6b9">p4est_init</a></div><div class="ttdeci">void p4est_init(sc_log_handler_t log_handler, int log_threshold)</div><div class="ttdoc">Registers p4est with the SC Library and sets the logging behavior.</div></div>
<div class="ttc" id="ap4est__bits_8h_html"><div class="ttname"><a href="p4est__bits_8h.html">p4est_bits.h</a></div><div class="ttdoc">Routines for manipulating quadrants (neighbors, parents, children, etc.)</div></div>
<div class="ttc" id="ap4est__bits_8h_html_a280866adc8089fa7117c08304c950ef4"><div class="ttname"><a href="p4est__bits_8h.html#a280866adc8089fa7117c08304c950ef4">p4est_quadrant_is_ancestor</a></div><div class="ttdeci">int p4est_quadrant_is_ancestor(const p4est_quadrant_t *q, const p4est_quadrant_t *r)</div><div class="ttdoc">Test if a quadrant is an ancestor of another quadrant.</div></div>
<div class="ttc" id="ap4est__bits_8h_html_a2b0cbbd87c0bc9d640fb0ee8b32d9a0f"><div class="ttname"><a href="p4est__bits_8h.html#a2b0cbbd87c0bc9d640fb0ee8b32d9a0f">p4est_quadrant_child_id</a></div><div class="ttdeci">int p4est_quadrant_child_id(const p4est_quadrant_t *q)</div><div class="ttdoc">Compute the position of this child within its siblings.</div></div>
<div class="ttc" id="ap4est__bits_8h_html_a78be9585dd09db13844006c2ea69c0d8"><div class="ttname"><a href="p4est__bits_8h.html#a78be9585dd09db13844006c2ea69c0d8">p4est_quadrant_is_equal</a></div><div class="ttdeci">int p4est_quadrant_is_equal(const p4est_quadrant_t *q1, const p4est_quadrant_t *q2)</div><div class="ttdoc">Test if two quadrants have equal Morton indices.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a04e5eba4d0b5de6286228b43171c3237"><div class="ttname"><a href="p4est__connectivity_8h.html#a04e5eba4d0b5de6286228b43171c3237">p4est_connectivity_new_drop</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_drop(void)</div><div class="ttdoc">Create a connectivity structure for a five-trees geometry with a hole.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a0fd421c8379a095e89ad804c0c12e971"><div class="ttname"><a href="p4est__connectivity_8h.html#a0fd421c8379a095e89ad804c0c12e971">p4est_connectivity_new_corner</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_corner(void)</div><div class="ttdoc">Create a connectivity structure for a three-tree mesh around a corner.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a12894fe664f1f5607ff94aef7893339e"><div class="ttname"><a href="p4est__connectivity_8h.html#a12894fe664f1f5607ff94aef7893339e">p4est_connectivity_new_cubed</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_cubed(void)</div><div class="ttdoc">Create a connectivity structure for the six sides of a unit cube.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a208e613cae5e1bd3baffb587387b672c"><div class="ttname"><a href="p4est__connectivity_8h.html#a208e613cae5e1bd3baffb587387b672c">p4est_connectivity_destroy</a></div><div class="ttdeci">void p4est_connectivity_destroy(p4est_connectivity_t *connectivity)</div><div class="ttdoc">Destroy a connectivity structure.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a28ee3ef55210cd2b88cefced9ac14f70"><div class="ttname"><a href="p4est__connectivity_8h.html#a28ee3ef55210cd2b88cefced9ac14f70">p4est_connectivity_new_disk</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_disk(int periodic_a, int periodic_b)</div><div class="ttdoc">Create a connectivity structure for a five-tree flat spherical disk.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a3405dfcd7ac8f55a1f792fc011bd72c9"><div class="ttname"><a href="p4est__connectivity_8h.html#a3405dfcd7ac8f55a1f792fc011bd72c9">p4est_connectivity_new_unitsquare</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_unitsquare(void)</div><div class="ttdoc">Create a connectivity structure for the unit square.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a360c55d8055be2c0a8984ccd71cb5cd6"><div class="ttname"><a href="p4est__connectivity_8h.html#a360c55d8055be2c0a8984ccd71cb5cd6">p4est_connectivity_new_disk2d</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_disk2d(void)</div><div class="ttdoc">Create a connectivity structure that maps a 2d disk.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a3613c1c140e3475b184d7f96af5c2ef3"><div class="ttname"><a href="p4est__connectivity_8h.html#a3613c1c140e3475b184d7f96af5c2ef3">p4est_connectivity_new_shell2d</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_shell2d(void)</div><div class="ttdoc">Create a connectivity structure that builds a 2d spherical shell.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a3a17dfaa5e0f668db6e2ab79b7d906fe"><div class="ttname"><a href="p4est__connectivity_8h.html#a3a17dfaa5e0f668db6e2ab79b7d906fe">p4est_connectivity_new_rotwrap</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_rotwrap(void)</div><div class="ttdoc">Create a connectivity structure for a periodic unit square.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a4d767547ff8aae4a453c2e96ebce9918"><div class="ttname"><a href="p4est__connectivity_8h.html#a4d767547ff8aae4a453c2e96ebce9918">p4est_connectivity_new_brick</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_brick(int mi, int ni, int periodic_a, int periodic_b)</div><div class="ttdoc">A rectangular m by n array of trees with configurable periodicity.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a4fb8c54e19a1b8843f7d6b92b579c0bd"><div class="ttname"><a href="p4est__connectivity_8h.html#a4fb8c54e19a1b8843f7d6b92b579c0bd">p4est_connectivity_new_circle</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_circle(void)</div><div class="ttdoc">Create a connectivity structure for an donut-like circle.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a63201cf8e928e60ce884ebdbe13730ee"><div class="ttname"><a href="p4est__connectivity_8h.html#a63201cf8e928e60ce884ebdbe13730ee">p4est_connectivity_new_pillow</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_pillow(void)</div><div class="ttdoc">Create a connectivity structure for two trees on top of each other.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a77bccda549718827993b5790ca79a509"><div class="ttname"><a href="p4est__connectivity_8h.html#a77bccda549718827993b5790ca79a509">p4est_connectivity_new_icosahedron</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_icosahedron(void)</div><div class="ttdoc">Create a connectivity for mapping the sphere using an icosahedron.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a7bc5f541b475afbfa6cb997587d49ec7"><div class="ttname"><a href="p4est__connectivity_8h.html#a7bc5f541b475afbfa6cb997587d49ec7">p4est_connectivity_new_bowtie</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_bowtie(void)</div><div class="ttdoc">Create a connectivity structure that maps a 2d bowtie structure.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_a7fd7fb1c260d827d7e64a2cbe562bf27"><div class="ttname"><a href="p4est__connectivity_8h.html#a7fd7fb1c260d827d7e64a2cbe562bf27">p4est_connectivity_new_star</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_star(void)</div><div class="ttdoc">Create a connectivity structure for a six-tree star.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_adc5f6166fc408c325589ce3e620552caa5bf35c11d90c02cb481e9edadb51bda7"><div class="ttname"><a href="p4est__connectivity_8h.html#adc5f6166fc408c325589ce3e620552caa5bf35c11d90c02cb481e9edadb51bda7">P4EST_CONNECT_FULL</a></div><div class="ttdeci">@ P4EST_CONNECT_FULL</div><div class="ttdoc">= CORNER.</div><div class="ttdef"><b>Definition:</b> p4est_connectivity.h:119</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_ae6564b782958454d9bc3ed02b23ae627"><div class="ttname"><a href="p4est__connectivity_8h.html#ae6564b782958454d9bc3ed02b23ae627">p4est_connectivity_new_moebius</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_moebius(void)</div><div class="ttdoc">Create a connectivity structure for a five-tree moebius band.</div></div>
<div class="ttc" id="ap4est__connectivity_8h_html_aeec450942d8ceb63c8a26e217846838b"><div class="ttname"><a href="p4est__connectivity_8h.html#aeec450942d8ceb63c8a26e217846838b">p4est_connectivity_new_periodic</a></div><div class="ttdeci">p4est_connectivity_t * p4est_connectivity_new_periodic(void)</div><div class="ttdoc">Create a connectivity structure for an all-periodic unit square.</div></div>
<div class="ttc" id="ap4est__extended_8h_html"><div class="ttname"><a href="p4est__extended_8h.html">p4est_extended.h</a></div><div class="ttdoc">Interface routines with extended capabilities.</div></div>
<div class="ttc" id="ap4est__extended_8h_html_a59df906152ad91e56010e3f3bda991f0"><div class="ttname"><a href="p4est__extended_8h.html#a59df906152ad91e56010e3f3bda991f0">p4est_new_ext</a></div><div class="ttdeci">p4est_t * p4est_new_ext(sc_MPI_Comm mpicomm, p4est_connectivity_t *connectivity, p4est_locidx_t min_quadrants, int min_level, int fill_uniform, size_t data_size, p4est_init_t init_fn, void *user_pointer)</div><div class="ttdoc">Create a new forest.</div></div>
<div class="ttc" id="ap4est__geometry_8h_html_a196bb1ad3a9ccab822675609e46395cc"><div class="ttname"><a href="p4est__geometry_8h.html#a196bb1ad3a9ccab822675609e46395cc">p4est_geometry_new_shell2d</a></div><div class="ttdeci">p4est_geometry_t * p4est_geometry_new_shell2d(p4est_connectivity_t *conn, double R2, double R1)</div><div class="ttdoc">Create a geometry for mapping the annulus.</div></div>
<div class="ttc" id="ap4est__geometry_8h_html_a1ca45d79b5883113280368706ac45164"><div class="ttname"><a href="p4est__geometry_8h.html#a1ca45d79b5883113280368706ac45164">p4est_geometry_new_sphere2d</a></div><div class="ttdeci">p4est_geometry_t * p4est_geometry_new_sphere2d(p4est_connectivity_t *conn, double R)</div><div class="ttdoc">Create sphere geometry associated to cubed connectivity.</div></div>
<div class="ttc" id="ap4est__geometry_8h_html_a291fa1714141de267265cf1591009fe7"><div class="ttname"><a href="p4est__geometry_8h.html#a291fa1714141de267265cf1591009fe7">p4est_geometry_new_disk2d</a></div><div class="ttdeci">p4est_geometry_t * p4est_geometry_new_disk2d(p4est_connectivity_t *conn, double R0, double R1)</div><div class="ttdoc">Create disk2d geometry associated to disk2d connectivity.</div></div>
<div class="ttc" id="ap4est__geometry_8h_html_a6db4e8809e2bde8a76ce2edfacc0ca50"><div class="ttname"><a href="p4est__geometry_8h.html#a6db4e8809e2bde8a76ce2edfacc0ca50">p4est_geometry_new_icosahedron</a></div><div class="ttdeci">p4est_geometry_t * p4est_geometry_new_icosahedron(p4est_connectivity_t *conn, double R)</div><div class="ttdoc">Create a geometry for mapping the sphere using 2d connectivity icosahedron.</div></div>
<div class="ttc" id="ap4est__geometry_8h_html_ad389d94045e366e64a0c7854739f1f8f"><div class="ttname"><a href="p4est__geometry_8h.html#ad389d94045e366e64a0c7854739f1f8f">p4est_geometry_destroy</a></div><div class="ttdeci">void p4est_geometry_destroy(p4est_geometry_t *geom)</div><div class="ttdoc">Can be used to conveniently destroy a geometry structure.</div></div>
<div class="ttc" id="ap4est__vtk_8h_html"><div class="ttname"><a href="p4est__vtk_8h.html">p4est_vtk.h</a></div><div class="ttdoc">Routines for printing a forest and associated fields to VTK format.</div></div>
<div class="ttc" id="ap4est__vtk_8h_html_a9e8a44b027b5372824a2c1ef2c17dea8"><div class="ttname"><a href="p4est__vtk_8h.html#a9e8a44b027b5372824a2c1ef2c17dea8">p4est_vtk_write_file</a></div><div class="ttdeci">void p4est_vtk_write_file(p4est_t *p4est, p4est_geometry_t *geom, const char *filename)</div><div class="ttdoc">Write the p4est in VTK format.</div></div>
<div class="ttc" id="astructp4est__connectivity_html"><div class="ttname"><a href="structp4est__connectivity.html">p4est_connectivity</a></div><div class="ttdoc">This structure holds the 2D inter-tree connectivity information.</div><div class="ttdef"><b>Definition:</b> p4est_connectivity.h:190</div></div>
<div class="ttc" id="astructp4est__geometry_html"><div class="ttname"><a href="structp4est__geometry.html">p4est_geometry</a></div><div class="ttdoc">Encapsulates a custom transformation from tree-local coordinates to user defined physical space.</div><div class="ttdef"><b>Definition:</b> p4est_geometry.h:86</div></div>
<div class="ttc" id="astructp4est__quadrant_html"><div class="ttname"><a href="structp4est__quadrant.html">p4est_quadrant</a></div><div class="ttdoc">The 2D quadrant datatype.</div><div class="ttdef"><b>Definition:</b> p4est.h:72</div></div>
<div class="ttc" id="astructp4est__quadrant_html_a0f92ad9bd71d9e3f82246d2768ff23ad"><div class="ttname"><a href="structp4est__quadrant.html#a0f92ad9bd71d9e3f82246d2768ff23ad">p4est_quadrant::level</a></div><div class="ttdeci">int8_t level</div><div class="ttdoc">level of refinement</div><div class="ttdef"><b>Definition:</b> p4est.h:76</div></div>
<div class="ttc" id="astructp4est__quadrant_html_a84896efd4c9ace3225253e379fb48a6e"><div class="ttname"><a href="structp4est__quadrant.html#a84896efd4c9ace3225253e379fb48a6e">p4est_quadrant::p</a></div><div class="ttdeci">union p4est_quadrant::p4est_quadrant_data p</div><div class="ttdoc">a union of additional data attached to a quadrant</div></div>
<div class="ttc" id="astructp4est__quadrant_html_ad226034132b973fe7955ef797938dea0"><div class="ttname"><a href="structp4est__quadrant.html#ad226034132b973fe7955ef797938dea0">p4est_quadrant::y</a></div><div class="ttdeci">p4est_qcoord_t y</div><div class="ttdoc">coordinates</div><div class="ttdef"><b>Definition:</b> p4est.h:74</div></div>
<div class="ttc" id="astructp4est_html"><div class="ttname"><a href="structp4est.html">p4est</a></div><div class="ttdoc">The p4est forest datatype.</div><div class="ttdef"><b>Definition:</b> p4est.h:136</div></div>
<div class="ttc" id="astructp4est_html_a486eacc9c8e6ce28ff34429d297e703f"><div class="ttname"><a href="structp4est.html#a486eacc9c8e6ce28ff34429d297e703f">p4est::user_pointer</a></div><div class="ttdeci">void * user_pointer</div><div class="ttdoc">convenience pointer for users, never touched by p4est</div><div class="ttdef"><b>Definition:</b> p4est.h:143</div></div>
<div class="ttc" id="astructp4est_html_a5b7b11eb9050eede87019bdb831a20b3"><div class="ttname"><a href="structp4est.html#a5b7b11eb9050eede87019bdb831a20b3">p4est::mpirank</a></div><div class="ttdeci">int mpirank</div><div class="ttdoc">this process's MPI rank</div><div class="ttdef"><b>Definition:</b> p4est.h:139</div></div>
<div class="ttc" id="aunionp4est__quadrant_1_1p4est__quadrant__data_html_aff6684573d249ebf6af9f035aff5e1a0"><div class="ttname"><a href="unionp4est__quadrant_1_1p4est__quadrant__data.html#aff6684573d249ebf6af9f035aff5e1a0">p4est_quadrant::p4est_quadrant_data::user_data</a></div><div class="ttdeci">void * user_data</div><div class="ttdoc">never changed by p4est</div><div class="ttdef"><b>Definition:</b> p4est.h:81</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/>
</body>
</html>
