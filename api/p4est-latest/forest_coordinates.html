<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>p4est: The p4est coordinate system</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">p4est
   &#160;<span id="projectnumber">2.8.6.259-54a6</span>
   </div>
   <div id="projectbrief">p4est is a software library for parallel adaptive mesh refinement.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The <a class="el" href="structp4est.html" title="The p4est forest datatype.">p4est</a> coordinate system </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The forest-of-octrees coordinate system.</p>
<p>A <a class="el" href="group__p4est.html">p4est</a> mesh is constructed by first defining one or more trees, each of which is logically a square (2D) or cube (3D), and linking them where they touch topologically. This creates an unstructured conforming hexahedral mesh. The trees may be arbitrarily rotated and folded back onto each other. Thus, the all-periodic unit cube is a possibility as well as a Moebius strip or other self-connecting connectivities. Of course, a simple unit cube or a rectangular brick pattern works fine. It is also possible to convert the output of a hex mesh generator to a <a class="el" href="structp4est.html" title="The p4est forest datatype.">p4est</a> connectivity programmatically. For details, please see the page on <a class="el" href="connectivity.html">The connectivity structure</a>.</p>
<p>Each tree can be filled by a single root quadrant, for example by calling <a class="el" href="p4est__bits_8h.html#a571cd89e7cf1723a5d0702146d62a61f">p4est_quadrant_root</a>, or a set of descendants as long as there are no gaps or overlaps between the quadrants. Quadrants may be refined calling <a class="el" href="p4est__bits_8h.html#a7b2a9661bdc593d3cc5aee6e5e131c0c">p4est_quadrant_children</a>, and aggregated back to their common parent by <a class="el" href="p4est__bits_8h.html#abf3fcf47f480c00a590f005807c71b9b">p4est_quadrant_parent</a>. These quadrants are positioned within the unit tree by the coordinate tuple of their lower left corner. We use an integer coordinate system for the quadrant coordinates. The lower left corner of the tree is at the origin, and the length of the unit tree is <a class="el" href="p4est_8h.html#ae26167f0411d9845caa84be6d50c0cee">P4EST_ROOT_LEN</a>. The latter variable is equal to the number of quadrants in one direction at the deepest possible refinement level <a class="el" href="p4est_8h.html#a9202bc92ab91dc2b7914e01bb27f8b23">P4EST_MAXLEVEL</a> with one caveat discussed as follows.</p>
<p>Sometimes it is useful to distinguish the coordinates of all quadrant boundary points: its corners, face midpoints, edge midpoints in 3D, and the volume midpoint. There are 3** <a class="el" href="p4est__connectivity_8h.html#a2c4786e65053166a16b7afb2711d35cb">P4EST_DIM</a>, or <a class="el" href="p4est__connectivity_8h.html#a6b0d01b9120eb484106f5a61d2531d8a">P4EST_INSUL</a>, of these points total. Since they sit at the half-length of the quadrant, we allow quadrants only as deep (fine) as they still separate all midpoints by at least one. This is the reason that quadrants may only be refined one level less than coordinates, namely to <a class="el" href="p4est_8h.html#a398bac71234696389c90d0f986bb31aa">P4EST_QMAXLEVEL</a>.</p>
<p>Quadrants have finite length, so their lower left coordinates are always strictly less than <a class="el" href="p4est_8h.html#ae26167f0411d9845caa84be6d50c0cee">P4EST_ROOT_LEN</a>. The quadrant boundary coordinates on the upper right may however reach to this value inclusively. This means coordinates are still considered inside the unit tree, <a class="el" href="p4est__bits_8h.html#a718799d86f590417fab1ccba78c6b3b8">p4est_coordinates_is_inside_root</a>, when they are on any tree boundary. For quadrants, this is only true for its origin point, verified by <a class="el" href="p4est__bits_8h.html#ab8f88e83d54ea09df2a0d5da476f25e0">p4est_quadrant_is_inside_root</a>.</p>
<p>The discussion so far applies regardless to which tree a quadrant is considered to be in. We never store the tree number directly inside a mesh quadrant (we only do this for interface/meta structures like the <a class="el" href="p4est__ghost_8h.html#aaa1000659b80aeb802788aac34dcbf5c">p4est_ghost_t</a> layer). The tree is usually apparent by context, since each tree stores its local quadrants in a separate array. Still, when trees touch at some (tree corner, edge, or face) point, that coordinate may have different values seen from any of the touching trees.</p>
<p>If the need arises to determine a unique coordinate representation of an inter-tree boundary point, for example for hashing, see <a class="el" href="p4est__connectivity_8h.html#a35a4816ff10305a61d0e749ec9888a6d">p4est_connectivity_coordinates_canonicalize</a>. This function uses the tree neighbor information in the <a class="el" href="p4est__connectivity_8h.html#a7bfc76825a73a3764b063ef476ed62f3">p4est_connectivity_t</a> to calculate the lowest tree number this coordinate point touches, and the coordinate values transformed into that tree's system. If a coordinate touches the same tree in different places (like for a periodic mesh), it calculates the lowest coordinate among those touching the lowest numbered tree.</p>
<p>In practice, coordinates are rarely used. However, they provide a convenient route to identify quadrant neighbors, since for example a mesh corner at the cross of four (2D) or eight (3D) quadrants leads to the same coordinate tuple and derived hash from all of these perspectives. For an example of using this mechanism, and as a guide to use the hash functionality available, see <a class="el" href="test_coordinates2_8c-example.html">test_coordinates2.c</a> (containing code for both the 2D and the 3D program). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/>
</body>
</html>
